# 推推接口实现方案
## 1. 总体目标
```
    (1) 接收机器人发送过来的扫码用户信息
    (2) 机器人根据手机号获取代理用户信息
    (3) 
```

## 2. 接口定义

### 2.1 内部模板短信发送接口
- 接口访问方式
    + HTTP POST
- 接口URI定义
    + /api/msg/sms/send/inal.php
- 接口参数定义
    + 参数格式：json
    + 参数示例： 
       {
          "appKey": "WiFiAuth",
          "areaCode": "86",
          "mobile": "",
          "tplId": "8605",
          "extends": {
            "code": "2358",
            "time": "10:31:33"
          }
        }

    + 参数说明
        * appKey: 由短信中心分配给app的appKey， 必填。 服务端必须验证合法性。
        * areaCode: 国家代码,可为空，为空时默认为中国区号：0086
        * mobile: 手机号码。服务器端会进行合法性校验： 长度为11位时默认国内号码，根据国内号码规则进行校验，长度大于11位默认为国际号码，根据国际规则进行校验（暂时没有）。
        * tplId: 短信模板id， 必填。 服务端必须验证合法性。
        * extends: 短信模板内需要替换的字符串，不带前后的“#”。服务端前后加带“#”替换，
                替换完成后需要校验是否存在“#”， 如果存在，则说明内容不匹配，返回失败。


- 接口返回值定义
    + 返回值格式：json
    + 返回值示例：

        {
            "code": "0",
            "message": "OK"
        }
    
    + 返回值字段说明
        * code: 结果码。 0：成功；其他：失败
        * message: 错误说明，code!=0时有效


### 2.2 外部模版短信发送接口
- 接口访问方式
    + HTTP POST
- 接口URI定义
    + /api/mgs/sms/send/inet.php
- 接口参数定义
    + 参数格式：json
    + 参数示例：
        {
          "appKey": "WiFiAuth",
          "areaCode": "86",
          "mobile": "",
          "tplId": "8605",
          "extends": {
            "code": "2358",
            "time": "10:31:33"
          },
          "sign": "xxxx"
        }

    + 参数说明
        * appKey: 由短信中心分配给app的appKey， 必填。 服务端必须验证合法性。
        * areaCode: 国家代码,可为空，为空时默认为中国区号：0086
        * mobile: 手机号码。服务器端会进行合法性校验： 长度为11位时默认国内号码，根据国内号码规则进行校验，长度大于11位默认为国际号码，根据国际规则进行校验（暂时没有）。
        * tplId: 短信模板id， 必填。 服务端必须验证合法性。
        * extends: 短信模板内需要替换的字符串，不带前后的“#”。服务端前后加带“#”替换，
                替换完成后需要校验是否存在“#”， 如果存在，则说明内容不匹配，返回失败。
        * sign: 签名，根据给定的签名算法计算得到的签名，服务端会对签名进行校验。
        

- 接口返回值定义
    + 返回值格式：json
    + 返回值示例：

        {
            "code": "0",
            "message": "OK"
        }
    
    + 返回值字段说明
        * code: 结果码。 0：成功；其他：失败
        * message: 错误说明，code!=0时有效


## 3. 短信中心配置
### 3.1 短信网关信息配置
    配置文件中配置。

### 3.2 短信模板配置
    从数据库s_sms.cfg_sms_tpl表获取。

### 3.3 app配置
    从数据库s_sms.cfg_sms_app获取。

## 4. 加密算法
    待完善。



